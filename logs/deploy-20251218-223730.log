[0;36mâ„¹  Target: root@mittonvillage.com:/var/www/galaxy-miner[0m
[0;36mâ„¹  Domain: galaxyminer.mittonvillage.com[0m
[0;32mâœ“ Deployment lock acquired[0m

[0;34m==>[1m Checking local prerequisites[0m
[0;32mâœ“ tar is installed[0m
[0;32mâœ“ node is installed (v22.21.0)[0m
[0;32mâœ“ SSH key found: /home/eric/.ssh/id_ed25519[0m
[0;32mâœ“ .env.production found[0m
[0;32mâœ“ ecosystem.config.js found[0m
[0;32mâœ“ package.json found[0m

[0;34m==>[1m Running pre-deployment validation[0m
[0;36mâ„¹  Running test suite...[0m

> galaxy-miner@1.0.0 test
> vitest run

[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m

 RUN  v2.1.9 /home/eric/Projects/galaxy-miner

 âœ“ tests/unit/shared/utils.test.js (41 tests) 4ms
 âœ“ tests/unit/shared/physics.test.js (34 tests) 15ms
 âœ“ tests/unit/server/auth.test.js (21 tests) 268ms

 Test Files  3 passed (3)
      Tests  96 passed (96)
   Start at  22:37:30
   Duration  458ms (transform 39ms, setup 0ms, collect 49ms, tests 287ms, environment 0ms, prepare 192ms)

[0;32mâœ“ Tests passed[0m
[0;32mâœ“ Pre-deployment validation passed[0m

[0;34m==>[1m Checking SSH connectivity[0m
[0;32mâœ“ SSH connection to mittonvillage.com verified[0m

[0;34m==>[1m Checking remote prerequisites[0m
[0;32mâœ“ Remote node: v20.19.6[0m
[0;32mâœ“ Remote npm installed[0m
[0;32mâœ“ Remote pm2 installed[0m
[0;32mâœ“ Remote nginx installed[0m
[0;32mâœ“ Remote certbot installed[0m

[0;34m==>[1m Creating remote backup[0m
[0;36mâ„¹  No existing deployment to backup[0m

[0;34m==>[1m Creating deployment package[0m
[0;36mâ„¹  Packaging application files...[0m
[0;32mâœ“ Deployment package created: 4.4M[0m

[0;34m==>[1m Transferring to remote server[0m
[0;36mâ„¹  Uploading deployment package...[0m
[0;32mâœ“ Package uploaded[0m
[0;36mâ„¹  Extracting on remote server...[0m
[0;32mâœ“ Package extracted[0m
[0;32mâœ“ Code deployed[0m

[0;34m==>[1m Installing dependencies[0m
[0;36mâ„¹  Installing production dependencies (this may take a moment)...[0m
[0;32mâœ“ Dependencies installed[0m

[0;34m==>[1m Deploying environment configuration[0m
[0;32mâœ“ Environment file deployed[0m

[0;34m==>[1m Checking database[0m
[0;36mâ„¹  Database not found, will be created on first run[0m
[0;32mâœ“ Data directory prepared[0m

[0;34m==>[1m Deploying with PM2[0m
[0;36mâ„¹  Starting PM2 process for the first time...[0m
[0;32mâœ“ PM2 deployment complete[0m

[0;34m==>[1m Deploying Nginx configuration[0m
[0;32mâœ“ Nginx config deployed[0m
[0;36mâ„¹  Enabling Nginx site...[0m
[0;36mâ„¹  Testing Nginx configuration...[0m
[0;31mâœ— Nginx config test failed - NOT reloading[0m
[0;36mâ„¹  Cleaned up local deployment package[0m
